From 2fb6334fce79f95cd8c0a9e8150f57edf474f355 Mon Sep 17 00:00:00 2001
From: Andrew Kyle Purtell <apurtell@apache.org>
Date: Wed, 22 Jan 2014 20:17:59 +0000
Subject: [PATCH 19/73] Amend HBASE-10338 Fix NPE if the server is terminated before the RegionServerCoprocessorHost is initialized (Vandana Ayyalasomayajula)

Reason: Bug
Author: Andrew Purtell
Ref: CDH-16936

git-svn-id: https://svn.apache.org/repos/asf/hbase/branches/0.96@1560496 13f79535-47bb-0310-9956-ffa450edef68
---
 .../hadoop/hbase/regionserver/HRegionServer.java   |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

diff --git a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
index 2eae776..240e6b3 100644
--- a/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
+++ b/hbase-server/src/main/java/org/apache/hadoop/hbase/regionserver/HRegionServer.java
@@ -1661,7 +1661,9 @@ public class HRegionServer implements ClientProtos.ClientService.BlockingInterfa
   @Override
   public void stop(final String msg) {
     try {
-      this.rsHost.preStop(msg);
+    	if (this.rsHost != null) {
+    		this.rsHost.preStop(msg);
+    	}
       this.stopped = true;
       LOG.info("STOPPED: " + msg);
       // Wakes run() if it is sleeping
-- 
1.7.0.4

